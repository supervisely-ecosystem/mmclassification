<sly-card
        title="Input Project"
        subtitle="Download images and annotations from server to local app directory"
        :options="{collapsable: true}"
        :collapsed.sync="state.collapsed1"
        ref="step1"
>
    <sly-field title="" description="Project">
        <a slot="title" target="_blank"
           :href="`/projects/${data.projectId}/datasets`">{{data.projectName}} ({{data.projectImagesCount}}
            images)</a>
        <sly-icon slot="icon" :options="{ imageUrl: `${data.projectPreviewUrl}` }"/>
    </sly-field>

    <el-select v-model="state.trainData">
        <el-option key="images" label="train on images" value="images"></el-option>
        <el-option key="objects" label="train on objects" value="objects"></el-option>
    </el-select>


    <div v-if="state.trainData === 'objects'">
        <el-row :gutter="10" type="flex">
            <el-col :span="8">
                <sly-field title="Choose classes"
                           subtitle="Selected classes"
                           style="margin-top: 10px">
                    <div v-for="(item,index) in data.classes" :key="index">
                        <el-checkbox class="mt5"
                                     v-model="state.classesSelected[index]"
                                     :disabled="state.classesDisabled[index] || data.finished === true">
                            <i class="zmdi zmdi-circle mr5 ml5" :style="{color: item.color}"></i>{{item.title}}
                            <span style="color: #5a6772;" class="ml15"><i
                                    class="zmdi zmdi-shape mr5"></i>{{item.shape}}</span>
                        </el-checkbox>
                    </div>
                </sly-field>

                <sly-field :disabled="data.finished === true" title="Settings" style="margin-top: 10px">
                    <sly-field title="Padding for objects crop"
                               description="Padding is measured in percent of corresponding side
                                        (width of height of bounding box)">
                        <div class="fflex">
                            <el-input-number :disabled="data.finished === true"
                                             v-model="state.cropPadding" :min="0" :max="50"
                                             size="small" :controls="true"></el-input-number>
                            <b class="ml5">%</b>
                        </div>
                    </sly-field>


                    <div style="border-bottom: 1px solid #e3e6ec; margin: 10px 0"></div>
                    <sly-field title="Resize crop"
                               description="All cropped objects images will be resized to input resolution">
                        <div class="fflex">
                            <div style="margin-right: 3px">W x H :</div>
                            <el-input-number :disabled="data.finished === true || state.autoSize"
                                             v-model="state.inputWidth" style="width:60px" :min="64" :max="1024"
                                             size="small" :controls="false"></el-input-number>
                            <div style="margin: 0 3px">x</div>
                            <el-input-number :disabled="data.finished === true || state.autoSize"
                                             v-model="state.inputHeight" style="width:60px" :min="64" :max="1024"
                                             size="small" :controls="false"></el-input-number>
                            <el-checkbox class="ml10"
                                         :disabled="data.finished === true"
                                         v-model="state.autoSize"
                                         label="Original size">
                            </el-checkbox>
                        </div>
                    </sly-field>
                    <div style="border-bottom: 1px solid #e3e6ec; margin: 10px 0"></div>

                </sly-field>
            </el-col>

            <el-col :span="16" style="flex: 1">
                <sly-card :disabled="data.finished === true" title="Preview on random image"
                          subtitle="Preview cropped objects from random original image from project"
                          style="margin-top: 10px">
                    <div slot="header">
                        <el-button :disabled="data.finished === true"
                                   type="primary" @click="command('preview'); state.showEmptyMessage=false">
                            <i class="zmdi zmdi-grid" style="margin-right: 5px"></i> Preview
                        </el-button>
                    </div>
                    <sly-grid-gallery v-if="data.previewProgress === 100" :content="data.preview.content"
                                      :options="data.preview.options">
                        <template v-slot:card-footer="{ annotation }">
                            <h3>{{annotation.title}}</h3>
                        </template>
                    </sly-grid-gallery>
                    <el-progress v-if="data.previewProgress !== 100" :percentage="data.previewProgress"></el-progress>
                </sly-card>
            </el-col>
        </el-row>
    </div>


    <el-button
            type="primary"
            class="regular"
            :loading="!!data.progress1"
            @click="command('download_project')"
            v-if="!data.done1 && state.trainData === 'images'">
        Download
    </el-button>

    <el-button
            type="primary"
            class="regular"
            :loading="!!data.progress1"
            @click="command('download_project')"
            v-if="!data.done1 && state.trainData === 'objects'">
        Download
    </el-button>

    <div v-if="data.progress1" class="mt10">
        <div style="color: #20a0ff">{{data.progress1}}: {{data.progressCurrent1}} / {{data.progressTotal1}}</div>
        <el-progress :percentage="data.progressPercent1"></el-progress>
    </div>
    <div v-if="data.done1">
        <i class="zmdi zmdi-check-circle mr5" style="color: #13ce66"></i>
        <span style="color: #5a6772;">Project has been successfully downloaded</span>
    </div>
</sly-card>